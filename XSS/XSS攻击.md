# XSS攻击
## 缓冲区溢出和XSS
1. 缓冲区溢出和XSS代表了二进制软件和脚本软件（包括绝大多数Web软件都是脚本软件开发的）两大技术方向。
## 二进制软件和脚本软件的区别:
1. 计算机的底层，是CPU直接执行在内存中的机器指令，C和C++这类编程语言开发的软件，有一个过程，叫编译链接，其实就是为了把程序变成CPU可以直接执行的二进制指令。
2. 这类软件的一个特点，就是需要直接操作内存。内存是所有在运行态的软件及其数据保存的地方。内存分为细小的单元，每个单元有一个唯一的地址。所有要访问数据，必须知道数据的地址，要保存新的数据，就必须分配内存，获得可用的地址。地址也是数，计算错误，那么就会访问到不该访问的数据，就会造成数据的泄露或者破坏。这就是二进制软件安全问题的根源。
3. 使用C语言和C++就不可避免的一个东西：直接操作内存，也就是指针。在C和C++发展成熟以后，就有人去研究如何降低编程的难度，可不可以避免程序员编程时直接操作内存，把需要操作内存的地方，都封装起来。屏蔽在编程语言的内部。就发明了脚本语言。
4. 脚本语言，是干脆用C和C++这样的二进制程序开一个软件来执行一种新的程序，也就是用软件来模拟CPU工作。但是软件的可定制性比CPU就高多了，可以想定义什么指令就定义什么指令。把所有需要操作内存的东西，全部封闭在执行器内部，只给程序员接口，不给程序员操作内存的机会。这就是对象。比如把字符串封装为string对象。只能调用string.len()这样的方法来操作这个对象。所有python java js这样的程序，都有一个二进制程序的执行器。比如python.exe，java.exe，Web浏览器等。这些脚本程序的执行器，都是二进制程序。
5. 虽然这些脚本程序没有了内存相关问题，有引出了其他的问题：
* 比如XSS的问题。就是web程序，存在一种高交互性。
* web是互联网时代的软件的基本框架，所有一定会有用户提交数据。当初为了网页动态的需求，开发了网页的前端脚本，比如js。直接把脚本嵌入到网页中。浏览器只要发现了script标签，就去当做脚本来执行。把网页按照程序员的定制，变的丰富多彩，变得富于变化
* 恰恰另外一种需求，就是UGC软件，所谓用户产生内容。也就是网页的内容来展示用户提交的内容，这种软件已经非常常见了。比如BBS、博客、微博，电商视频网站的用户评论，都会涉及到用户提交的内容在页面上呈现。这两种机制，放在一起就产生了神奇的效果。当用户提交的内容里含有脚本时，如果直接将用户提交的内容放在页面上，那么用户提交的内容中的脚本可能会被浏览器解析执行，那么一个用户提交了一个脚本就可以在这个页面的所有用户主机上执行。用户能提交程序执行了，就无法保证这个程序不是恶意的。前端脚本，除了渲染页面元素这样的功能，还有获得用户的输入跳转页面到其他地址等等丰富的功能。
-----
# 课外实验——XSS
## 实验背景
**在上学期的环境下进行搭建**
* Windows主机
* 延用上学期的实验，用apache服务器和php来完成的 
## 实验过程
1. 编写一个简单的html文件(htdocs/1.html)，这个文件只要有一个表单，用户就可以在表单中输入数据，向服务器提交。
```html
<html>
<body>
<form method="post">
        <input type="text">
        <button>提交</button>
      </form>
</body>
</html>
```
2. 搭建一个web服务器，使用的是apache服务器，如果这个html是放在web服务器上，用户输入了数据，点击提交，浏览器就会把编辑框中的数据封装为一个POST请求，发现服务器。服务器会把这个数据发给后端脚本来处理。可以通过定义from的属性来指明需要哪个脚本文件来处理，比如这里使用的是PHP程序，有一个POST超级变量，当用户提交了数据以后，对应的php脚本的post变量就是用户提交的数据。
* htdocs/action.php
```php
<?php
    echo "Hello Worls!";
    echo "<br>当前时间为：".date("Y-m-d H:i:s");
    $name=$_POST["name"]; 
    echo $name;  
?>
```
4. `localhost://1.html`访问后，在对话框里输入`<script>alert('hack')</script>`              
![](./img/ok.png)                 
![](./img/after.png)               
